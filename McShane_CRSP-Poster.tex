%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% %%	Posterdown PDF class for LaTeX files	 01-AUG-2022
%% %%	For any information or to submit issues please visit:
%% %%		https://github.com/math-mcshane/posterdownLaTeX (Ryan McShane)
%% %%
%% %%	Initial class provided by: Brent Thorne
%% %% Contributors: Shea Connell (SC)
%% %% Maintainer: Ryan McShane
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\documentclass[article,30pt,extrafontsizes]{memoir}

%utf-8 seems to be important
\RequirePackage[utf8]{inputenc}
\RequirePackage[T1]{fontenc}
\RequirePackage{lmodern}
\RequirePackage{multicol}
\RequirePackage{graphicx}
\RequirePackage{lipsum}
\RequirePackage{blindtext}
\RequirePackage[svgnames,table]{xcolor}
\RequirePackage{tikz}
\RequirePackage[framemethod=tikz]{mdframed}
\RequirePackage{color}
\RequirePackage{geometry}
\RequirePackage{adjmulticol}
\RequirePackage[skins,most,listings,skins]{tcolorbox}

%For kable extra package :)
\RequirePackage{booktabs}
\RequirePackage{longtable}
\RequirePackage{array}
\RequirePackage{multirow}
\RequirePackage{wrapfig}
\RequirePackage{float}
\RequirePackage{colortbl}
\RequirePackage{pdflscape}
\RequirePackage{pagecolor}
\RequirePackage{tabu}
\RequirePackage{threeparttable}
\RequirePackage{threeparttablex}
\RequirePackage[normalem]{ulem}
\RequirePackage{makecell}
\RequirePackage{wrapfig}

%rof hyperrefs
\RequirePackage{hyperref}
\hypersetup{
    colorlinks=true,
    linkcolor=linkcol,
    citecolor=citecol,
    filecolor=linkcol,
    urlcolor=urlcol,
}
%For figure and table placement
\RequirePackage{float}
\floatplacement{figure}{H}
\floatplacement{table}{H}

%%%%%%%%% COLOURS %%%%%%%%
%Fill/ Line Colours
\definecolor{titleboxbgcol}{HTML}{311a4d}
\definecolor{titleboxbordercol}{HTML}{777777}
\definecolor{columnlinecol}{HTML}{000000}
\definecolor{bodybgcol}{HTML}{FFFFFF}
\definecolor{sectitlebgcol}{HTML}{5D3C85}
\definecolor{sectitlebordercol}{HTML}{111111}
% Text Colours
\definecolor{titletextcol}{HTML}{FFFFFF}
\definecolor{authortextcol}{HTML}{ffffff}
\definecolor{affiliationtextcol}{HTML}{FFFFFF}
\definecolor{sectitletextcol}{HTML}{FFFFFF}
\definecolor{bodytextcol}{HTML}{000000}
\definecolor{footnotetextcol}{HTML}{000000}
\definecolor{citecol}{HTML}{005500}
\definecolor{urlcol}{HTML}{002c6b}
\definecolor{linkcol}{HTML}{002c6b}


%Memoir spacing options
%spacing between figure/ table and caption
\setlength{\abovecaptionskip}{0.4in}
\setlength{\belowcaptionskip}{0.2in}
\captionnamefont{\footnotesize\sffamily\bfseries}
\captiontitlefont{\footnotesize\sffamily}

%define column options
\setlength{\columnseprule}{2pt}
\def\columnseprulecolor{\color{columnlinecol}}

%define section title features
\setsubsubsecheadstyle{\small\color{sectitletextcol}\textbf}% Set \section style
\setsecnumformat{}
\def\sectionmark#1{\markboth{#1}{#1}}

%%%%%%%%%%%% TCOLORBOXES TO THE RESCUE %%%%%%%%%%%%%%%%%%%%
%Title Box
\newtcolorbox{topbox}{
enhanced,
colback=titleboxbgcol,
colframe=titleboxbordercol,
halign=center,
boxrule=4pt,
sharp corners=all,
 overlay={
    \node[anchor=south west]
      at ([xshift=.55in,yshift=.55in]frame.south west)
       {\includegraphics[width=2.8in]{logo/AmherstCollege-Seal\_WhiteRGB.pdf}};
    \node[anchor=south east]
      at ([xshift=-.55in,yshift=.55in]frame.south east)
       {\includegraphics[width=2.8in]{logo/AmherstCollege-Seal\_WhiteRGB.pdf}};}

}
%Body Section Title Box
\newtcolorbox{myboxstuff}[1][]{
code={\parindent=0em},
colframe=sectitlebordercol,
nobeforeafter,
left skip=0pt,
valign=center,
halign=center,
fontupper=\large\bfseries,
colupper=sectitletextcol,
boxrule=2pt,
colback=sectitlebgcol,
sharp corners=uphill, #1}
\newcommand{\mybox}[1]{%
\begin{myboxstuff}
\strut #1
\end{myboxstuff}%
}
\makeheadstyles{MyBox}{
    \setsecheadstyle{\mybox}
}
\headstyles{MyBox}\makepagestyle{MyBox}
%-----------------------------------------------------
%Make sure that the page is empty of any preset items from memoir
\thispagestyle{empty}

%biblatex options
\RequirePackage[sorting=none,backend=biber]{biblatex}
\renewcommand*{\bibfont}{\scriptsize} %% SC
\bibliography{references}
\defbibheading{bibliography}[\bibname]{%
\setlength\bibitemsep{\itemsep} %% SC
\section*{#1}%
\markboth{#1}{#1}}
\AtBeginDocument{%
  \renewcommand{\bibname}{References}
}

%Remove section numbering & set 2nd level header as first level
%to avoid the automatic new page generated from memoir chapter
%formatting
\counterwithout{section}{chapter}
\makechapterstyle{mydefault}{
\addtocounter{secnumdepth}{2}
\setsecheadstyle{\mybox}
\setsubsecheadstyle{\itshape}
\setsubsubsecheadstyle{\itshape}
}

%set the chapterstyle
\chapterstyle{mydefault}

%define column spacing
\setlength\columnsep{18mm}

%spacing params
\setlength\parindent{0em}
\setlength\parskip{0em}
\setlength\hangparas{0}

%spacing after section head title
\setaftersecskip{0em}
\setbeforesecskip{1.5em}
\setlength\textfloatsep{0in}
\setlength\floatsep{0in}
\setlength\intextsep{0in}

\setstocksize{24in}{36in}
\settrimmedsize{\stockheight}{\stockwidth}{*}
\settypeblocksize{24in}{36in}{*}
\setlrmargins{0pt}{*}{1}
\setulmarginsandblock{0pt}{*}{*}
\setmarginnotes{0em}{0cm}{0cm}
\setlength{\footskip}{0cm}
\setlength{\footnotesep}{0cm}
\setlength{\headheight}{0pt}
\setlength{\headsep}{0pt}
\setlength{\trimtop}{0pt}
\setlength{\trimedge}{0pt}
\setlength{\uppermargin}{0pt}
\checkandfixthelayout

%Footnote to white
\RequirePackage{footmisc}
\def\footnotelayout{\centering\color{footnotetextcol}}

% see https://stackoverflow.com/a/47122900

% choose font family
\RequirePackage{palatino}

% define the BODYBGCOL
\newpagecolor{bodybgcol}

%sets footnote to be white hopefully
\renewcommand\footnoterule{}
\renewcommand{\thempfootnote}{\footnotesize\color{footnotetextcol}{\arabic{mpfootnote}}}

%include arbitrary input from header-includes field
\usepackage[outline]{contour}
\definecolor{citegreen}{HTML}{005500}
\definecolor{codegray}{HTML}{f9f9f9}
\definecolor{codeletter}{HTML}{002c6b}
\let\textttOrig\texttt
\renewcommand{\texttt}[1]{\textttOrig{\textbf{\textcolor{codeletter}{\colorbox{codegray}{#1}}}}}
\usepackage{fontspec, bm}
\setmainfont{Jost-Regular}[Extension=.ttf,BoldFont=Jost-Bold,ItalicFont=Jost-Italic,BoldItalicFont=Jost-BoldItalic]
\usepackage{booktabs}
\usepackage{longtable}
\usepackage{array}
\usepackage{multirow}
\usepackage{wrapfig}
\usepackage{float}
\usepackage{colortbl}
\usepackage{pdflscape}
\usepackage{tabu}
\usepackage{threeparttable}
\usepackage{threeparttablex}
\usepackage[normalem]{ulem}
\usepackage{makecell}
\usepackage{xcolor}

%-------------- Begin Document -------------------%
\begin{document}

%-------------- Title Box Start ------------------%
%tcolorbox allows for pictures hopefully
\begin{topbox}
  \color{titletextcol}
  \vspace{0.5in}
  \normalsize{\huge \textbf{\textit{Scissors beats Rock} \Large \&  other failures of Transitive Models using Paired Comparisons}}  \\[0.3in]
  \color{authortextcol} \LARGE{\contour{black}{\textbf{Ryan P. A. McShane, Ph.D.}}} \\[0.2in]
  \color{affiliationtextcol} \normalsize{Former Visiting Assistant
Professor of Statistics, Amherst College}
  \vspace{1cm}
\end{topbox}
%--------------- Title Box End -------------------%
%----------------- Body Start --------------------%
% Begin body of poster
\begin{adjmulticols}{3}{18mm}{18mm}
\normalsize{
\color{bodytextcol}
\vspace{-2mm}

\begin{minipage}[]{.85\columnwidth}

\footnotesize
This poster was created using my revived version of the \texttt{\textbf{\textcolor{codeletter}{\colorbox{codegray}{posterdownLaTeX}}}} \texttt{\textbf{\textcolor{codeletter}{\colorbox{codegray}{R}}}} package. The code needed to produce this poster can be found at

\textbf{github.com/math-mcshane/IMS-NRC-2022-Poster-and-Presentation}

\end{minipage}
\hfill \hfill
\begin{minipage}{.125\columnwidth}

\raisebox{-.4\height}{\includegraphics[clip=true,width = 4cm]{Figures/GitHubQR}}

\end{minipage}

\vspace{-10mm}

\hypertarget{abstract}{%
\section{Abstract}\label{abstract}}

\normalsize

If the Utah Jazz beat the Portland Trailblazers and the Trailblazers
beat the Denver Nuggets, does that mean that the Jazz are better than
the Nuggets, or could the Nuggets actually be better than the Jazz? To
answer this question, we investigate the assumption of transitivity. We
propose a novel linear model (CRSP) whose latent bilinear fixed effect
allows us to estimate deviations from our transitive model (C).
Additionally, we consider extensions.

\vspace{-3mm}

\hypertarget{paired-comparisons-and-intransitivity}{%
\section{Paired Comparisons and
(In)transitivity}\label{paired-comparisons-and-intransitivity}}

\begin{minipage}[]{.75\columnwidth}

Classically \cite{Thu1927} $n$ objects are compared [teams compete] one pair at a time, until all $n \choose 2$ comparisons are made. Then, object [team] ratings are derived and subsequently ranks. First documented in 1283 to select a pope \cite{Llu1283}. $\;\;\;\;\mathbf{\xrightarrow{\hspace{2.5cm}}}$

\end{minipage}
\hfill \hfill
\begin{minipage}{.215\columnwidth}

\vspace{5pt}

\begin{center}\includegraphics[width=0.9\linewidth]{images/LlullExample} \end{center}
\vspace{1pt}

\end{minipage}

\vspace{2pt}

\begin{figure}

\begin{minipage}[]{.48\columnwidth}

\textbf{Transitive Property of \\ Inequality}: 

Let $a, b, c$ be real numbers (team ratings).

If $a > b$ and $b > c$, then $a > c$.

\end{minipage}
\hfill \hfill
\begin{minipage}{.48\columnwidth}

\textbf{Weak Stochastic Transitive Property.}: 

Let $A, B, C$ be teams. If $P(A \rightarrow B)$, $P(B \rightarrow C) > 0.5$, then $P(A \rightarrow C) > 0.5.$

\end{minipage}

\vspace{-3mm}


\begin{center}\includegraphics[width=1\linewidth]{images/WSTransitivity} \end{center}

\vspace{-11mm}

Every common paired comparisons model (Bradley-Terry, Elo, Trueskill, etc) assumes at least the WST Property \cite{McShane2019Intransitive}. 

\vspace{7mm}

We introduce a model (CRSP) that does allow intransitivity. For the following, assume that a double round robin has been observed -- all teams $i$ play all teams $j$, $i \neq j$, $n_{ij} = n_{ji} = 1$ times.


\end{figure}

\columnbreak

\hypertarget{chain-model-transitive}{%
\section{Chain Model (Transitive)}\label{chain-model-transitive}}

We want to model \(y_{ij}\), the score of home team \(i\) minus the
score of away team \(j\). We consider several models of the form
\(y_{ij} = \mu_{ij} +\varepsilon_{ij}\), where \(\varepsilon_{ij}\)
independent and \(\sigma_{\varepsilon}\) constant. The first is the
\textbf{Chain model} with fixed effect strength parameters \(\alpha_i\)
for team \(i\) and home effect \(h\), for the expected score
differential \(\mu_{ij}\) when team \(i\) hosts team \(j\):

\vspace{-10pt}

\begin{figure}

$$\mu_{ij} = h + \alpha_i - \alpha_j$$

\vspace{-10pt}

Finding solutions for $\hat h$ and $\boldsymbol{\hat\alpha}$ is straight forward:

\vspace{-30pt}

$$\hat{h} = ({\sqrt{2}n})^{-2}\boldsymbol{1}^T(\boldsymbol{Y} - \boldsymbol{Y}^T)\boldsymbol{1} = \bar{y}_{..}$$

\vspace{-50pt}

$$\hat{\alpha}_i = 2^{-1}(\bar{y}_{i.} - \bar{y}_{.i}) \Rightarrow \boldsymbol{\hat{\alpha}} = (2n)^{-1} \big[\boldsymbol{Y} - \boldsymbol{Y}^T \big] \boldsymbol{1}$$
\end{figure}
\vspace{-35pt}

\hypertarget{crsp-chain-rock-scissors-paper-model}{%
\section{CRSP (Chain Rock-Scissors-Paper)
Model}\label{crsp-chain-rock-scissors-paper-model}}

We can make the \(\mu_{ij}\) intransitive by including a fixed
interaction effect \(\beta_{ij}\), where \(\beta_{ij} = -\beta_{ji}\)
and \(\Sigma_j \beta_{ij} = 0 \; \forall i\) (this will overfit when
\(n_{ij}\) small):

\begin{figure}

\vspace{-25pt}

$$\mu_{ij} = h + \alpha_i - \alpha_j + \beta_{ij}$$


\vspace{-15pt}

\begin{minipage}[]{.79\columnwidth}

We instead introduce the notion of circular triads, $\boldsymbol{T}$, from \cite{KendallSmith1940}: 
\vspace{-55pt}
$$\boldsymbol{T} = \left[ \begin{array}{rrr}
0 & 1 & -1\\
-1 & 0 & 1\\
1 & -1 & 0
\end{array}\right].$$

\end{minipage}
\hfill \hfill
\begin{minipage}{.20\columnwidth}

\vspace{8pt}

\begin{center}\includegraphics[width=0.9\linewidth]{images/SPR} \end{center}
\end{minipage}

We propose an alternative to $\beta_{ij}$, $f(\boldsymbol{\beta}_i, \boldsymbol{\beta}_j)$, with $\boldsymbol{\beta}_i = \big[r_i \; \; \; s_i \; \; \; p_i\big]$ and let $r_i + s_i + p_i = 0$,
\vspace{-30pt}

$$f(\boldsymbol{\beta}_i, \boldsymbol{\beta}_j) = \boldsymbol{\beta}_i^T\boldsymbol{T\beta}_j \propto r_is_j - s_ir_j.$$

\vspace{-10pt}

This gives us our \textbf{CRSP model} with $\boldsymbol{r}, \boldsymbol{s}$ orthogonal 

\vspace{-30pt}

$$\mu_{ij} = h + \alpha_i - \alpha_j + r_is_j - r_js_i.$$

\vspace{-10pt}

Extension: \textbf{Generalized CRSP model}, $K \in \{ 0, 1, ..., \big[ \frac{n-1}{2} \big] \}$:

\vspace{-30pt}

$$\mu_{ij} = h + \alpha_i - \alpha_j + \Sigma_{k= 1}^K r_{ik}s_{jk} - s_{ik}r_{jk}.$$

\vspace{-10pt}

Finding solution to $\bm{\hat r, \hat s}$, where $\bm{C}$ is the residual matrix: 

\vspace{-55pt}

$$\boldsymbol{C} = 2^{-1}(\boldsymbol{Y} - \boldsymbol{Y}^T) - (\bm{\hat \alpha 1}^T - (\bm{\hat \alpha 1}^T)^T) = \Sigma_{k=1}^K \bm{r}_k\bm{s}_k^T - \bm{s}_k\bm{r}_k^T.$$

\vspace{-25pt}

$\bm{r}_k$ and $\bm{s}_k$ are the eigenvectors of $\bm C \bm C^T$. The $\bm r_k, \bm s_k$ with the largest eigenvalue pair are the solutions to the CRSP model, second largest eigenvalues to the second intransitive vector pair in generalized CRSP, etc. See Ch. 4 of \cite{McShane2019Intransitive} for more details.  

\end{figure}

\columnbreak

\hypertarget{chain-and-crsp-example-2017-nba-data}{%
\section{Chain and CRSP Example (2017 NBA
Data)}\label{chain-and-crsp-example-2017-nba-data}}

We use all data from the 2016-2017 NBA season, where repeated games are
averaged. We estimate
\(\hat{h} = 2.89, \; \hat{\alpha}_{GSW} = 11.27, \hat{\alpha}_{SAS} = 7.91, \; \hat{\alpha}_{HOU} = 4.93, \; \hat{\alpha}_{LAC} = 4.33, ...\).
Displayed are the relative differences of team strengths,
\(\alpha_i - \alpha_j\).

\begin{figure}



\begin{center}\includegraphics[width=0.9\linewidth]{images/Chain_Graph} \end{center}

\vspace{-45pt}

This is the chain model. Note that $\hat{\alpha}_{GSW} - \hat{\alpha}_{HOU} = ( \hat{\alpha}_{GSW} - \hat{\alpha}_{SAS}) + (\hat{\alpha}_{SAS} - \hat{\alpha}_{HOU}) = 6.34$. Now, we take the residuals, $\bm{C}$ and find the eigendecomposition of $\bm{CC}^T$. We get, for example, $\hat r_{GSW} = -3.40, \hat r_{SAS} = 0.86, \hat s_{GSW} = 0.29, \hat s_{SAS} = 1.10$. Then, if $h = 0$, $\mu_{SAS,GSW} = \hat \alpha_{SAS} - \hat \alpha_{GSW} + \hat r_{SAS}\hat s_{GSW} - \hat r_{GSW}\hat s_{SAS} = 0.62$. 


\vspace{-30pt}


\begin{center}\includegraphics[width=0.9\linewidth]{images/CRSP_differences_Graph} \end{center}


\end{figure}

\vspace{-50pt}

\hypertarget{ongoing-work}{%
\section{Ongoing Work}\label{ongoing-work}}

\textrm{1. EM Algorithm for incomplete cases, 2. How to pick $K$ in Generalized CRSP, 3. Weights $\omega_{ijh}$ for game $h$ b/w $i$ and $j$, 4. Clustering players and line-ups, use CRSP at line-up level, and identify team-level intransitivity causes. 5. Smash N64 application -- player $\gamma_\ell$, character $\alpha_i, r_is_j - r_js_i$. 6. Possible digraphs.}

\vspace{10pt}
\begin{figure}
\printbibliography
\end{figure}
\vspace{-60pt}
}
\end{adjmulticols}
%------------------ Body End ---------------------%
%end the poster
\end{document}
